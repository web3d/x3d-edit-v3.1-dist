<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<!--Generated using XSLT processor: SAXON 8.7 from Saxonica--><html xmlns="http://www.w3.org/TR/xhtml1/strict">
   <head>
      <title>CoordinateInterpolator2dPrototype.x3d (X3dToXhtml)</title>
      <style type="text/css">
span.element {color: navy}
span.attribute {color: green}
span.value {color: teal}
span.plain {color: black}
span.gray  {color: gray}
span.prototype {color: purple}
a.prototype {color: purple, visited: black}
span.route {color: red}
span.nodeName {color: maroon}
a.nodeName {color: maroon}
div.center {text-align: center}
div.indent {margin-left: 25px}
b.warning {color: #CC5500}
b.error {color: #CC0000}
	</style>
      <meta name="generator" content="http://www.web3d.org/x3d/content/X3dToXhtml.xslt"/>
      <link rel="shortcut icon"
            href="http://www.web3d.org/x3d/content/icons/X3DtextIcon16.png"
            title="X3D"/>
   </head>
   <body>
      <pre>
&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;!DOCTYPE X3D PUBLIC "ISO//Web3D//DTD X3D 3.0//EN"   "http://www.web3d.org/specifications/x3d-3.0.dtd"&gt;</pre>

&lt;<span class="element">X3D</span>&#160;<span class="attribute">version</span>='<span class="value">3.0</span>'&#160;<span class="attribute">profile</span>='<span class="value">Immersive</span>'&#160;<span class="attribute">xmlns:xsd</span>='<a href="http://www.w3.org/2001/XMLSchema-instance" target="_blank">http://www.w3.org/2001/XMLSchema-instance</a>' <span class="attribute">xsd:noNamespaceSchemaLocation</span>='
<a href="http://www.web3d.org/specifications/x3d-3.0.xsd">http://www.web3d.org/specifications/x3d-3.0.xsd</a> '&gt;
<div class="indent">
&lt;<span class="element">head</span>&gt;
<div class="indent">
&lt;<span class="element">meta</span>&#160;<span class="attribute">name</span>='<span class="value">title</span>'&#160;<span class="attribute">content</span>='<a href="CoordinateInterpolator2dPrototype.x3d" target="_blank">CoordinateInterpolator2dPrototype.x3d</a>'/&gt;
<br />
&lt;<span class="element">meta</span>&#160;<span class="attribute">name</span>='<span class="value">description</span>'&#160;<span class="attribute">content</span>='<span class="plain">CoordinateInterpolator2D prototype declaration, to interpolate across an array of Vector2FloatArray/MFVec2f values to produce an interpolated Vector2FloatArray - click text to see example.</span>'/&gt;
<br />
&lt;<span class="element">meta</span>&#160;<span class="attribute">name</span>='<span class="value">creator</span>'&#160;<span class="attribute">content</span>='<span class="value">Don Brutzman, Jeff Weekley, Jane Wu</span>'/&gt;
<br />
&lt;<span class="element">meta</span>&#160;<span class="attribute">name</span>='<span class="value">created</span>'&#160;<span class="attribute">content</span>='<span class="value">28 June 2001</span>'/&gt;
<br />
&lt;<span class="element">meta</span>&#160;<span class="attribute">name</span>='<span class="value">modified</span>'&#160;<span class="attribute">content</span>='<span class="value">25 December 2005</span>'/&gt;
<br />
&lt;<span class="element">meta</span>&#160;<span class="attribute">name</span>='<span class="value">reference</span>'&#160;<span class="attribute">content</span>='
<a href="http://www.web3d.org/technicalinfo/specifications/vrml97/part1/concepts.html#4.6.8">http://www.web3d.org/technicalinfo/specifications/vrml97/part1/concepts.html#4.6.8</a> '/&gt;
<br />
&lt;<span class="element">meta</span>&#160;<span class="attribute">name</span>='<span class="value">reference</span>'&#160;<span class="attribute">content</span>='
<a href="http://www.web3d.org/technicalinfo/specifications/vrml97/part1/nodesRef.html#CoordinateInterpolator">http://www.web3d.org/technicalinfo/specifications/vrml97/part1/nodesRef.html#CoordinateInterpolator</a> '/&gt;
<br />
&lt;<span class="element">meta</span>&#160;<span class="attribute">name</span>='<span class="value">subject</span>'&#160;<span class="attribute">content</span>='<span class="value">CoordinateInterpolator2D</span>'/&gt;
<br />
&lt;<span class="element">meta</span>&#160;<span class="attribute">name</span>='<span class="value">identifier</span>'&#160;<span class="attribute">content</span>='
<a href="http://www.web3d.org/x3d/content/examples/Basic/development/CoordinateInterpolator2dPrototype.x3d">http://www.web3d.org/x3d/content/examples/Basic/development/CoordinateInterpolator2dPrototype.x3d</a> '/&gt;
<br />
&lt;<span class="element">meta</span>&#160;<span class="attribute">name</span>='<span class="value">generator</span>'&#160;<span class="attribute">content</span>='<span class="value">X3D-Edit, </span>
            <a href="http://www.web3d.org/x3d/content/README.X3D-Edit.html" target="_blank">http://www.web3d.org/x3d/content/README.X3D-Edit.html</a>'/&gt;
<br />
&lt;<span class="element">meta</span>&#160;<span class="attribute">name</span>='<span class="value">license</span>'&#160;<span class="attribute">content</span>='<a href="../../license.html" target="_blank">../../license.html</a>'/&gt;
</div>&lt;/<span class="element">head</span>&gt;
<br />
&lt;!--
<div class="center">
            <hr width="100%"/>
            <i>Index for ProtoDeclare definition</i>: 
<a href="#ProtoDeclare_CoordinateInterpolator2D" class="prototype">CoordinateInterpolator2D</a>
<br />
<i>Index for DEF nodes</i>: 
<a href="#InterpolationScript" class="nodeName">InterpolationScript</a>,
<a href="#KeyHolder" class="nodeName">KeyHolder</a>,
<a href="#KeyValueHolder" class="nodeName">KeyValueHolder</a>
            <hr width="100%"/>
         </div>
--&gt;
<br />
&lt;<span class="element">Scene</span>&gt;
<div class="indent">
            <a name="ProtoDeclare_CoordinateInterpolator2D"> </a> 
&lt;<span class="prototype">ProtoDeclare</span>&#160;<span class="attribute">name</span>='<span class="prototype">CoordinateInterpolator2D</span>'&#160;<span class="attribute">appinfo</span>='<span class="value">Provide interpolation capability for Vector2FloatArray/MFVec2f values</span>'&#160;<span class="attribute">documentation</span>='
<a href="http://www.web3d.org/technicalinfo/specifications/vrml97/part1/concepts.html#4.6.8">http://www.web3d.org/technicalinfo/specifications/vrml97/part1/concepts.html#4.6.8</a> '&gt;
<div class="indent">
&lt;<span class="prototype">ProtoInterface</span>&gt;
<div class="indent">&lt;!-- Regular interpolator-style input --&gt;
<br /><a name="CoordinateInterpolator2DProtoField_set_fraction"> </a> 
&lt;<span class="prototype">field</span>&#160;<span class="attribute">name</span>='<span class="prototype">set_fraction</span>'&#160;<span class="attribute">type</span>='<span class="value">SFFloat</span>'&#160;<span class="attribute">accessType</span>='<span class="value">inputOnly</span>'
<br />
&#160;<span class="gray">appinfo</span>='<span class="gray">The set_fraction eventIn receives an SFFloat event and causes the interpolator function to evaluate, resulting in a value_changed eventOut with the same timestamp as the set_fraction event.</span>'/&gt;
<br /><a name="CoordinateInterpolator2DProtoField_set_key"> </a> 
&lt;<span class="prototype">field</span>&#160;<span class="attribute">name</span>='<span class="prototype">set_key</span>'&#160;<span class="attribute">type</span>='<span class="value">MFFloat</span>'&#160;<span class="attribute">accessType</span>='<span class="value">inputOnly</span>'/&gt;
<br /><a name="CoordinateInterpolator2DProtoField_key"> </a> 
&lt;<span class="prototype">field</span>&#160;<span class="attribute">name</span>='<span class="prototype">key</span>'&#160;<span class="attribute">type</span>='<span class="value">MFFloat</span>'&#160;<span class="attribute">accessType</span>='<span class="value">inputOutput</span>'
<br />
&#160;<span class="gray">appinfo</span>='<span class="gray">keyValue holds the array of Vector2FloatArrays that match each animation key.</span>'/&gt;
<br /><a name="CoordinateInterpolator2DProtoField_key_changed"> </a> 
&lt;<span class="prototype">field</span>&#160;<span class="attribute">name</span>='<span class="prototype">key_changed</span>'&#160;<span class="attribute">type</span>='<span class="value">MFFloat</span>'&#160;<span class="attribute">accessType</span>='<span class="value">outputOnly</span>'
<br />
&#160;<span class="gray">appinfo</span>='<span class="gray">Array sequentially increasing, typically [0..1].  Must have the same number of keys as keyValues.</span>'/&gt;
<br /><a name="CoordinateInterpolator2DProtoField_set_keyValue"> </a> 
&lt;<span class="prototype">field</span>&#160;<span class="attribute">name</span>='<span class="prototype">set_keyValue</span>'&#160;<span class="attribute">type</span>='<span class="value">MFVec2f</span>'&#160;<span class="attribute">accessType</span>='<span class="value">inputOnly</span>'
<br />
&#160;<span class="gray">appinfo</span>='<span class="gray">Array of integer values.  Must have the same number of keys as keyValues.</span>'/&gt;
<br /><a name="CoordinateInterpolator2DProtoField_keyValue"> </a> 
&lt;<span class="prototype">field</span>&#160;<span class="attribute">name</span>='<span class="prototype">keyValue</span>'&#160;<span class="attribute">type</span>='<span class="value">MFVec2f</span>'&#160;<span class="attribute">accessType</span>='<span class="value">inputOutput</span>'
<br />
&#160;<span class="gray">appinfo</span>='<span class="gray">keyValue holds the array of Vector2FloatArrays that match each animation key.</span>'/&gt;
<br /><a name="CoordinateInterpolator2DProtoField_keyValue_changed"> </a> 
&lt;<span class="prototype">field</span>&#160;<span class="attribute">name</span>='<span class="prototype">keyValue_changed</span>'&#160;<span class="attribute">type</span>='<span class="value">MFVec2f</span>'&#160;<span class="attribute">accessType</span>='<span class="value">outputOnly</span>'
<br />
&#160;<span class="gray">appinfo</span>='<span class="gray">Array of integer values.  Must have the same number of keys as keyValues.</span>'/&gt;
<br />&lt;!-- Regular interpolator-style output --&gt;
<br /><a name="CoordinateInterpolator2DProtoField_value_changed"> </a> 
&lt;<span class="prototype">field</span>&#160;<span class="attribute">name</span>='<span class="prototype">value_changed</span>'&#160;<span class="attribute">type</span>='<span class="value">MFVec2f</span>'&#160;<span class="attribute">accessType</span>='<span class="value">outputOnly</span>'
<br />
&#160;<span class="gray">appinfo</span>='<span class="gray">The interpolator function averages between respective keyValue Vector2FloatArrays, resulting in a Vector2FloatArray value_changed eventOut with the same timestamp as the set_fraction event.</span>'/&gt;
</div>&lt;/<span class="prototype">ProtoInterface</span>&gt;
<br />
&lt;<span class="prototype">ProtoBody</span>&gt;
<div class="indent">
&lt;<span class="element">Group</span>&gt;
<div class="indent">
&lt;<span class="element">Switch</span>&#160;<span class="attribute">whichChoice</span>='<span class="value">-1</span>'&gt;
<div class="indent">
                        <a name="KeyHolder"> </a> 
&lt;<span class="element">ScalarInterpolator</span>&#160;<span class="attribute">DEF</span>='<span class="nodeName">KeyHolder</span>'&gt;
<div class="indent">
&lt;<span class="element">IS</span>&gt;
<div class="indent">
&lt;<span class="element">connect</span>&#160;<span class="attribute">nodeField</span>='<span class="prototype">key</span>'&#160;<span class="attribute">protoField</span>='<span class="prototype"><a href="#CoordinateInterpolator2DProtoField_key" class="prototype">key</a></span>'/&gt;
</div>&lt;/<span class="element">IS</span>&gt;
</div>&lt;/<span class="element">ScalarInterpolator</span>&gt;
<br />
&lt;<span class="element">Shape</span>&gt;
<div class="indent">
&lt;<span class="element">IndexedFaceSet</span>&gt;
<div class="indent">
                              <a name="KeyValueHolder"> </a> 
&lt;<span class="element">TextureCoordinate</span>&#160;<span class="attribute">DEF</span>='<span class="nodeName">KeyValueHolder</span>'&gt;
<div class="indent">
&lt;<span class="element">IS</span>&gt;
<div class="indent">
&lt;<span class="element">connect</span>&#160;<span class="attribute">nodeField</span>='<span class="prototype">point</span>'&#160;<span class="attribute">protoField</span>='<span class="prototype"><a href="#CoordinateInterpolator2DProtoField_keyValue" class="prototype">keyValue</a></span>'/&gt;
</div>&lt;/<span class="element">IS</span>&gt;
</div>&lt;/<span class="element">TextureCoordinate</span>&gt;
</div>&lt;/<span class="element">IndexedFaceSet</span>&gt;
</div>&lt;/<span class="element">Shape</span>&gt;
</div>&lt;/<span class="element">Switch</span>&gt;
<br /><a name="InterpolationScript"> </a> 
&lt;<span class="element">Script</span>&#160;<span class="attribute">DEF</span>='<span class="nodeName">InterpolationScript</span>'&#160;<span class="attribute">directOutput</span>='<span class="value">true</span>'&gt;
<div class="indent">
&lt;<span class="prototype">field</span>&#160;<span class="attribute">name</span>='<span class="prototype">set_fraction</span>'&#160;<span class="attribute">type</span>='<span class="value">SFFloat</span>'&#160;<span class="attribute">accessType</span>='<span class="value">inputOnly</span>'/&gt;
<br />
&lt;<span class="prototype">field</span>&#160;<span class="attribute">name</span>='<span class="prototype">fraction</span>'&#160;<span class="attribute">type</span>='<span class="value">SFFloat</span>'&#160;<span class="attribute">accessType</span>='<span class="value">initializeOnly</span>'
<br />
&#160;<span class="gray">appinfo</span>='<span class="gray">local variable</span>'/&gt;
<br />
&lt;<span class="prototype">field</span>&#160;<span class="attribute">name</span>='<span class="prototype">set_key</span>'&#160;<span class="attribute">type</span>='<span class="value">MFFloat</span>'&#160;<span class="attribute">accessType</span>='<span class="value">inputOnly</span>'/&gt;
<br />
&lt;<span class="prototype">field</span>&#160;<span class="attribute">name</span>='<span class="prototype">keyHolderNode</span>'&#160;<span class="attribute">type</span>='<span class="value">SFNode</span>'&#160;<span class="attribute">accessType</span>='<span class="value">initializeOnly</span>'&gt;
<div class="indent">
&lt;<span class="element">ScalarInterpolator</span>&#160;<span class="attribute">USE</span>='<a href="#KeyHolder" class="nodeName">KeyHolder</a>'/&gt;
</div>&lt;/<span class="prototype">field</span>&gt;
<br />
&lt;<span class="prototype">field</span>&#160;<span class="attribute">name</span>='<span class="prototype">key_changed</span>'&#160;<span class="attribute">type</span>='<span class="value">MFFloat</span>'&#160;<span class="attribute">accessType</span>='<span class="value">outputOnly</span>'/&gt;
<br />
&lt;<span class="prototype">field</span>&#160;<span class="attribute">name</span>='<span class="prototype">set_keyValue</span>'&#160;<span class="attribute">type</span>='<span class="value">MFVec2f</span>'&#160;<span class="attribute">accessType</span>='<span class="value">inputOnly</span>'/&gt;
<br />
&lt;<span class="prototype">field</span>&#160;<span class="attribute">name</span>='<span class="prototype">keyValueHolderNode</span>'&#160;<span class="attribute">type</span>='<span class="value">SFNode</span>'&#160;<span class="attribute">accessType</span>='<span class="value">initializeOnly</span>'&gt;
<div class="indent">
&lt;<span class="element">TextureCoordinate</span>&#160;<span class="attribute">USE</span>='<a href="#KeyValueHolder" class="nodeName">KeyValueHolder</a>'/&gt;
</div>&lt;/<span class="prototype">field</span>&gt;
<br />
&lt;<span class="prototype">field</span>&#160;<span class="attribute">name</span>='<span class="prototype">keyValue_changed</span>'&#160;<span class="attribute">type</span>='<span class="value">MFVec2f</span>'&#160;<span class="attribute">accessType</span>='<span class="value">outputOnly</span>'/&gt;
<br />
&lt;<span class="prototype">field</span>&#160;<span class="attribute">name</span>='<span class="prototype">value_changed</span>'&#160;<span class="attribute">type</span>='<span class="value">MFVec2f</span>'&#160;<span class="attribute">accessType</span>='<span class="value">outputOnly</span>'/&gt;
<br />
&lt;<span class="element">IS</span>&gt;
<div class="indent">
&lt;<span class="element">connect</span>&#160;<span class="attribute">nodeField</span>='<span class="prototype">set_fraction</span>'&#160;<span class="attribute">protoField</span>='<span class="prototype"><a href="#CoordinateInterpolator2DProtoField_set_fraction" class="prototype">set_fraction</a></span>'/&gt;
<br />
&lt;<span class="element">connect</span>&#160;<span class="attribute">nodeField</span>='<span class="prototype">set_key</span>'&#160;<span class="attribute">protoField</span>='<span class="prototype"><a href="#CoordinateInterpolator2DProtoField_set_key" class="prototype">set_key</a></span>'/&gt;
<br />
&lt;<span class="element">connect</span>&#160;<span class="attribute">nodeField</span>='<span class="prototype">key_changed</span>'&#160;<span class="attribute">protoField</span>='<span class="prototype"><a href="#CoordinateInterpolator2DProtoField_key_changed" class="prototype">key_changed</a></span>'/&gt;
<br />
&lt;<span class="element">connect</span>&#160;<span class="attribute">nodeField</span>='<span class="prototype">set_keyValue</span>'&#160;<span class="attribute">protoField</span>='<span class="prototype"><a href="#CoordinateInterpolator2DProtoField_set_keyValue" class="prototype">set_keyValue</a></span>'/&gt;
<br />
&lt;<span class="element">connect</span>&#160;<span class="attribute">nodeField</span>='<span class="prototype">keyValue_changed</span>'&#160;<span class="attribute">protoField</span>='<span class="prototype"><a href="#CoordinateInterpolator2DProtoField_keyValue_changed" class="prototype">keyValue_changed</a></span>'/&gt;
<br />
&lt;<span class="element">connect</span>&#160;<span class="attribute">nodeField</span>='<span class="prototype">value_changed</span>'&#160;<span class="attribute">protoField</span>='<span class="prototype"><a href="#CoordinateInterpolator2DProtoField_value_changed" class="prototype">value_changed</a></span>'/&gt;
</div>&lt;/<span class="element">IS</span>&gt;
<br />
</div class="indent">
</div class="indent">
</div class="indent">
</div class="indent">
</div class="indent">
<code>
                           <b>&lt;![CDATA[</b>
                        </code>
                        <pre>
            ecmascript:

// internal global persistent variables
var previousFraction;
var previousFractionIndex;
var blockSize;
var outputArray;

function tracePrint (outputString)
{
	var traceEnabled = false;
	if (traceEnabled) Browser.print ('[CoordinateInterpolator2D] ' + outputString);
}
function forcePrint (outputString)
{
	Browser.print ('[CoordinateInterpolator2D] ' + outputString);
}
function initialize (timestamp)
{
	key      = keyHolderNode.key;
	keyValue = keyValueHolderNode.point;
	previousFractionIndex = -1;
	previousFraction = 0;
	// check key array ranges [0..1] and is monotonically increasing
	// check that size of keyValue array is integer multiple of size of key array
	tracePrint ('key            =' + key);
	tracePrint ('key.length=     ' + key.length);
	tracePrint ('keyValue=       ' + keyValue);
	tracePrint ('keyValue.length=' + keyValue.length);
	blockSize =  keyValue.length/key.length;
	tracePrint ('blockSize=' + blockSize);
	if (blockSize != Math.round(blockSize))
	{
	  forcePrint ('*** warning:  blockSize not an integer multiple. check sizes of key and keyValue');
	}
	if (key[0] != 0)
	{
	  forcePrint ('*** warning:  key[0] != 0');
	}
	if (key[key.length-1] != 1)
	{
	  forcePrint ('*** warning:  key[' + (key.length - 1) + '] != 1, reset from ' + key[key.length-1] + ' to 1');
	  key[key.length-1] = 1;
	}
	for (index = 0; index &lt; blockSize; index++)
	{
		if ((key[index] &lt; 0) || (key[index] &gt; 1))
		{
		   forcePrint ('*** warning:  key[' + index + '] = ' + key[index] + ', out of range [0..1]');
		}
	}
	// instantiate default array, later computations just update it
	outputArray = new MFVec2f ();
	for (index = 0; index &lt; blockSize; index++)
	{
		// dynamically grow outputArray to match initial block
		outputArray[index] = keyValue[index];
	}
	tracePrint ('initial outputArray=' + outputArray);
}

function set_fraction (inputFloat, timestamp) {
	fraction = inputFloat;
	tracePrint ('previousFractionIndex=' + previousFractionIndex
		 + ', fraction=' + fraction + ', previousFraction=' + previousFraction);

	if (fraction &lt; 0)
	{
		tracePrint ('*** illegal fraction ' + fraction + ' set to 0');
		fraction = 0;
		previousFractionIndex = 0; // first
	}
	else if (fraction &gt; 1)
	{
		forcePrint ('*** illegal fraction ' + fraction + ' set to 1');
		fraction = 1;
		previousFractionIndex = blockSize - 1; // last
	}
	else if (previousFractionIndex == -1)
	{
		previousFractionIndex = 0; // first
		tracePrint ('previousFractionIndex initialized for first event');
	}
	else if ((fraction &gt;= previousFraction) &amp;&amp; (fraction &gt;= key[previousFractionIndex+1]))
	{
		previousFractionIndex++;
	}
	else if (fraction &lt; previousFraction) // regress, or loop repeat without reaching one
	{
		previousFractionIndex = 0;
		while ((fraction &gt;= key[previousFractionIndex+1]) &amp;&amp; (previousFractionIndex &lt; blockSize))
		{
			previousFractionIndex++;
		}
		tracePrint ('reset/reincrement previousFractionIndex to ' + previousFractionIndex);
	}

	if (fraction == 1) // use final block
	{
		tracePrint ('(fraction == 1)');
		for (index = 0; index &lt; blockSize; index++)
		{
			// update outputArray with final four keyValues
			outputArray[4 - index] = keyValue[keyValue.length - index];
		}
		previousFractionIndex = -1; // setup for restart
		tracePrint ('finished final fraction==1 block');
	}
	// when fraction matches index, calculate value_changed from corresponding keyValue array
	else if (fraction == key[previousFractionIndex])
	{
		tracePrint ('(fraction == key[previousFractionIndex])');
		for (index = 0; index &lt; blockSize; index++)
		{
			// update outputArray - need to interpolate next
			outputArray[index] = keyValue[blockSize * (previousFractionIndex) + index];
		}
	}
	else // calculate value_changed by interpolating between adjacent keyValue arrays
	{
		partialFraction = fraction                     - key[previousFractionIndex];
		deltaFraction   = key[previousFractionIndex+1] - key[previousFractionIndex];
		percentFraction = partialFraction / deltaFraction;
	//	tracePrint ('deltaFraction   = ' + deltaFraction);
	//	tracePrint ('partialFraction = ' + partialFraction);
		tracePrint ('percentFraction = ' + percentFraction);
		for (index = 0; index &lt; blockSize; index++)
		{
			// no arithmetic operators provided for SFVec2f, treat element by element
			nextKeyValue  = keyValue[blockSize * (previousFractionIndex + 1) + index];
			priorKeyValue = keyValue[blockSize * (previousFractionIndex)     + index];
			deltaKeyValue = new SFVec2f (
						nextKeyValue[0] - priorKeyValue[0],
						nextKeyValue[1] - priorKeyValue[1]);
		//	tracePrint ('deltaKeyValue = ' + deltaKeyValue);
			// update outputArray
			outputArray[index][0] = keyValue[blockSize * (previousFractionIndex) + index][0]
			   + percentFraction * deltaKeyValue[0];
			outputArray[index][1] = keyValue[blockSize * (previousFractionIndex) + index][1]
			   + percentFraction * deltaKeyValue[1];
		}
	}
	value_changed = outputArray;
	previousFraction = fraction;
	tracePrint ('value_changed=' + value_changed);
}

function set_key (inputArray, timestamp) {
	key = inputArray;       // update key Vector2FloatArray
	keyHolderNode.key = key; // update holder
	initialize (timestamp); // reverify key, keyValue sizes
	key_changed = key;	// eventOut
}

function set_keyValue (inputArray, timestamp) {
	keyValue = inputArray;  	// update keyValue Vector2FloatArray
	keyValueHolderNode.point = keyValue; // update holder
	initialize (timestamp); 	// reverify key, keyValue sizes
	keyValue_changed = keyValue;	// eventOut
}
          </pre>
                        <code>
                           <b>]]&gt;</b>
                        </code>
<div class="indent">
<div class="indent">
<div class="indent">
<div class="indent">
<div class="indent">
</div>&lt;/<span class="element">Script</span>&gt;
</div>&lt;/<span class="element">Group</span>&gt;
</div>&lt;/<span class="prototype">ProtoBody</span>&gt;
</div>&lt;/<span class="prototype">ProtoDeclare</span>&gt;
<br />&lt;!-- ====================================== --&gt;
<br />&lt;!-- Example use --&gt;
<br />
&lt;<span class="element">Anchor</span>&#160;<span class="attribute">description</span>='<span class="value">CoordinateInterpolator2dExample</span>'&#160;<span class="attribute">parameter</span>='<span class="value">target=_blank</span>'
<br />
&#160;&#160;<span class="attribute">url</span>='
"<a href="CoordinateInterpolator2dExample.wrl">CoordinateInterpolator2dExample.wrl</a>"
"<a href="https://savage.nps.edu/Savage/Tools/Animation/CoordinateInterpolator2dExample.wrl">https://savage.nps.edu/Savage/Tools/Animation/CoordinateInterpolator2dExample.wrl</a>"
"<a href="CoordinateInterpolator2dExample.x3d">CoordinateInterpolator2dExample.x3d</a>"
"<a href="https://savage.nps.edu/Savage/Tools/Animation/CoordinateInterpolator2dExample.x3d">https://savage.nps.edu/Savage/Tools/Animation/CoordinateInterpolator2dExample.x3d</a>"
'&gt;
<div class="indent">
&lt;<span class="element">Shape</span>&gt;
<div class="indent">
&lt;<span class="element">Text</span>&#160;<span class="attribute">string</span>='<span class="value">"CoordinateInterpolator2dPrototype" "defines a prototype" ""
"Click on this text to see" "CoordinateInterpolator2dExample" " scene"</span>'&#160;<span class="attribute">solid</span>='<span class="value">true</span>'&gt;
<div class="indent">
&lt;<span class="element">FontStyle</span>&#160;<span class="attribute">justify</span>='<span class="value">"MIDDLE" "MIDDLE"</span>'&#160;<span class="attribute">size</span>='<span class="value">0.7</span>'/&gt;
</div>&lt;/<span class="element">Text</span>&gt;
<br />
&lt;<span class="element">Appearance</span>&gt;
<div class="indent">
&lt;<span class="element">Material</span>&#160;<span class="attribute">diffuseColor</span>='<span class="value">1 1 0.2</span>'/&gt;
</div>&lt;/<span class="element">Appearance</span>&gt;
</div>&lt;/<span class="element">Shape</span>&gt;
</div>&lt;/<span class="element">Anchor</span>&gt;
</div>&lt;/<span class="element">Scene</span>&gt;
</div>&lt;/<span class="element">X3D</span>&gt;
<br />
&lt;!--
<div class="center">
         <hr width="100%"/>
         <i>Index for ProtoDeclare definition</i>: 
<a href="#ProtoDeclare_CoordinateInterpolator2D" class="prototype">CoordinateInterpolator2D</a>
<br />
<i>Index for DEF nodes</i>: 
<a href="#InterpolationScript" class="nodeName">InterpolationScript</a>,
<a href="#KeyHolder" class="nodeName">KeyHolder</a>,
<a href="#KeyValueHolder" class="nodeName">KeyValueHolder</a>
         <hr width="100%"/>
      </div>
--&gt;
<p>
&lt;!-- Tag color codes:
&lt;<span class="element">Node</span>
         <span class="nodeName"> DEF</span>='<span class="nodeName">NodeName</span>' <span class="attribute">attribute</span>='<span class="value">value</span>'/&gt;
&lt;<span class="prototype">Prototype</span> 
         <span class="attribute">name</span>='<span class="prototype">ProtoName</span>'&gt;
	&lt;<span class="prototype">field</span>
         <span class="attribute">name</span>='<span class="prototype">fieldName</span>'/&gt; &lt;/<span class="prototype">Prototype</span>&gt; --&gt;
</p>
   </body>
</html>